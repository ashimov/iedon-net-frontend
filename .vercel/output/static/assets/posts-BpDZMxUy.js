import{c as v,I as z,d as q,o as u,a as P,b as j,e as w,u as g,_ as J,f as te,g as ne,M as ae,m as re,r as O,h as oe,i as y,w as se,v as le,j as d,n as ce,t as ue,k as x,p as B,F as T,l as D,S as ie,q as k,L as de,s as E,x as F,y as pe,V as ve}from"./index-BWyvaJGd.js";var fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"};function U(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){me(n,s,t[s])})}return n}function me(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var V=function(e,t){var r=U({},e,t.attrs);return v(z,U({},r,{icon:fe}),null)};V.displayName="MenuFoldOutlined";V.inheritAttrs=!1;var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};function R(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){ge(n,s,t[s])})}return n}function ge(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var A=function(e,t){var r=R({},e,t.attrs);return v(z,R({},r,{icon:_e}),null)};A.displayName="MenuUnfoldOutlined";A.inheritAttrs=!1;var he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 394c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H400V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v236H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h228v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h164c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V394h164zM628 630H400V394h228v236z"}}]},name:"number",theme:"outlined"};function W(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){ye(n,s,t[s])})}return n}function ye(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var C=function(e,t){var r=W({},e,t.attrs);return v(z,W({},r,{icon:he}),null)};C.displayName="NumberOutlined";C.inheritAttrs=!1;const be={class:"trigger"},Oe={class:"trigger-inner"},we=q({__name:"MenuTrigger",props:{trigger:{type:Boolean}},setup(n){return(e,t)=>(u(),P("div",be,[j("div",Oe,[e.trigger?(u(),w(g(A),{key:0})):(u(),w(g(V),{key:1}))])]))}}),Me=J(we,[["__scopeId","data-v-4d28f3b2"]]),Pe={id:"wrapper"},Ie={key:0,class:"pad"},Se={class:"header"},$e=["innerHTML"],ke=q({__name:"posts",setup(n){const e=te().t,t=ne(),r=t.currentRoute.value.params.id||null,s=new ae({html:!0});s.use(re,{attrs:{target:"_blank"}});const I=O(!1),f=O(null),c=O({}),S=O([]),M=O([]),p=O(!1),m=O(null),H=async o=>{var a,l;if(((a=f.value)==null?void 0:a.postId)!==o.postId)try{const i=B.get(`post_${o.postId}`);if(!i)m.value=o;else try{if(f.value=i,i.updatedAt===((l=c.value[i.category].find(h=>h.postId===i.postId))==null?void 0:l.updatedAt))return}catch(h){console.error(h)}const b=await x(e,`/list/post/${o.postId}`);if(b.success&&b.response){const h=b.response;h&&(f.value=h,B.set(`post_${o.postId}`,f.value))}}catch(i){console.error(i)}finally{m.value=null}},L=async o=>{c.value={},o.forEach(a=>{c.value[a.category]||(c.value[a.category]=[]),c.value[a.category].push(a)});try{M.value=[];for(const l in c.value)M.value.push(l);let a=!1;for(const l in c.value)if(r!==null){const i=c.value[l].find(b=>b.postId===Number(r));if(i){a=!0,S.value=[`post_${r}`],await H(i);break}continue}if(!a){t.replace({path:"/"});for(const l in c.value){S.value=[`post_${c.value[l][0].postId}`],await H(c.value[l][0]);break}}}catch(a){console.error(a)}},K=async()=>{let o=p.value;try{I.value=!0,p.value=!1;const a=await x(e,"/list/posts");if(a.success&&a.response){const l=a.response;Array.isArray(l.posts)&&(localStorage.setItem("posts",JSON.stringify(l.posts)),await L(l.posts))}}catch(a){console.error(a)}finally{I.value=!1,p.value=o}};oe(async()=>{try{const o=localStorage.getItem("posts");o&&await L(JSON.parse(o))}catch(o){console.error(o)}await K()});const G=async o=>{t.push({path:`/post/${o.postId}`}),window.scrollTo(0,0),(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<ve&&(p.value=!0),await H(o)},Z=()=>{p.value=!p.value,window.scrollTo(0,0)};return(o,a)=>{const l=y("a-menu-item"),i=y("a-sub-menu"),b=y("a-menu"),h=y("a-spin"),Q=y("a-layout-sider"),X=y("a-divider"),Y=y("a-skeleton"),ee=y("a-layout-content");return u(),P("section",Pe,[se(v(Q,{class:ce(`sider ${g(ue)}`),width:"300",collapsible:"",collapsed:p.value,"onUpdate:collapsed":a[2]||(a[2]=_=>p.value=_),trigger:null,breakpoint:"lg",collapsedWidth:40},{default:d(()=>[v(h,{spinning:I.value&&M.value.length===0},{default:d(()=>[I.value&&M.value.length===0?(u(),P("div",Ie)):(u(),w(b,{key:1,class:"menu",mode:"inline",selectedKeys:S.value,"onUpdate:selectedKeys":a[0]||(a[0]=_=>S.value=_),openKeys:M.value,"onUpdate:openKeys":a[1]||(a[1]=_=>M.value=_)},{default:d(()=>[(u(!0),P(T,null,D(c.value,(_,N)=>(u(),w(i,{key:N},{icon:d(()=>[v(g(ie))]),title:d(()=>[j("b",null,k(N),1)]),default:d(()=>[(u(!0),P(T,null,D(c.value[N],$=>(u(),w(l,{key:`post_${$.postId}`,onClick:He=>G($)},{icon:d(()=>[m.value&&m.value.postId===$.postId?(u(),w(g(de),{key:0})):(u(),w(g(C),{key:1}))]),default:d(()=>[E(" "+k($.title),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024))),128))]),_:1},8,["selectedKeys","openKeys"]))]),_:1},8,["spinning"])]),_:1},8,["class","collapsed"]),[[le,!p.value]]),v(ee,{class:"content"},{default:d(()=>{var _;return[j("h1",Se,k(m.value?m.value.title:((_=f.value)==null?void 0:_.title)||""),1),v(X,{orientation:"right"},{default:d(()=>[E(k(m.value?g(F)(m.value.updatedAt):f.value?g(F)(f.value.updatedAt):""),1)]),_:1}),v(Y,{active:"",loading:m.value!==null},{default:d(()=>[f.value?(u(),P("article",{key:0,id:"post",innerHTML:g(s).render(f.value.content)},null,8,$e)):pe("",!0)]),_:1},8,["loading"])]}),_:1}),v(Me,{trigger:p.value,onClick:Z},null,8,["trigger"])])}}}),je=J(ke,[["__scopeId","data-v-27e8d7af"]]);export{je as default};
