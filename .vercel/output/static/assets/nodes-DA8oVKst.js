import{d as b,f as A,g as T,M as B,m as D,r as g,h as F,z as J,N as V,i as u,o as n,a as i,b as c,q as p,u as o,c as r,F as H,l as q,k as z,e as G,j as f,G as O,O as K,s as y,y as v,n as j,t as U,H as x,J as M,K as Q,_ as W}from"./index-BWyvaJGd.js";import{R as X}from"./RouterLocationAvatar-DV68NB4O.js";import{A as Y}from"./ApiOutlined-BdJAwXEL.js";const Z={class:"header"},ee={class:"searchContainer"},se={key:0,id:"routers"},ae={key:0},te={key:1},oe={key:2},ne=["innerHTML"],ie={key:1,id:"noData"},le=b({__name:"nodes",setup(re){const t=A().t,C=T(),L=new B;L.use(D,{attrs:{target:"_blank"}});const h=g(!1),d=g([]),N=async()=>{try{h.value=!0;let e=await z(t,"/list/routers");if(e.success&&e.response){const a=e.response;a&&Array.isArray(a.routers)&&(d.value=a.routers.sort((m,_)=>(""+m.name).localeCompare(_.name)),localStorage.setItem("routers",JSON.stringify(d.value)))}}catch(e){console.error(e)}finally{h.value=!1}};F(async()=>{try{const e=localStorage.getItem("routers");e&&(d.value=JSON.parse(e))}catch(e){console.error(e)}await N()});const R=async e=>{try{await navigator.clipboard.writeText(JSON.stringify(e)),x.info(t("pages.nodes.copied"))}catch(a){console.error(a)}},k=e=>{if(!e.openPeering){M.error({centered:!0,title:e.name,content:t("pages.nodes.statusClosed")});return}if(e.sessionCount>=e.sessionCapacity){M.error({centered:!0,title:e.name,content:t("pages.nodes.statusFull")});return}if(!Q.value){x.info(t("pages.nodes.pleaseSignIn")),C.replace({path:"/signin"});return}C.push({path:`/nodes/${e.uuid}`})},l=g(""),w=J(()=>l.value.length===0?d.value:d.value.filter(e=>e.name!==void 0&&e.name!==null&&e.name.toLocaleLowerCase().indexOf(l.value.toLocaleLowerCase())!==-1||e.ipv4!==void 0&&e.ipv4!==null&&e.ipv4.indexOf(l.value)!==-1||e.ipv6!==void 0&&e.ipv6!==null&&e.ipv6.toLocaleLowerCase().indexOf(l.value.toLocaleLowerCase())!==-1||e.ipv6LinkLocal!==void 0&&e.ipv6LinkLocal!==null&&e.ipv6LinkLocal.toLocaleLowerCase().indexOf(l.value.toLocaleLowerCase())!==-1)),P=V.PRESENTED_IMAGE_SIMPLE;return(e,a)=>{const m=u("a-divider"),_=u("a-input-search"),S=u("a-card-meta"),$=u("a-card"),E=u("a-empty");return n(),i("section",null,[c("h1",Z,p(o(t)("pages.nodes.nodes")),1),r(m,{dashed:""}),c("div",ee,[r(_,{value:l.value,"onUpdate:value":a[0]||(a[0]=s=>l.value=s),placeholder:o(t)("pages.nodes.search"),class:"searchBox","enter-button":""},null,8,["value","placeholder"])]),w.value.length!==0?(n(),i("section",se,[(n(!0),i(H,null,q(w.value,s=>(n(),G($,{hoverable:"",class:"card",key:s.uuid,onClick:I=>k(s)},{actions:f(()=>[r(o(K),{onClick:O(I=>R(s),["stop"])},null,8,["onClick"]),r(o(Y),{onClick:O(I=>k(s),["stop"])},null,8,["onClick"])]),default:f(()=>[r(S,{title:s.name,description:`${s.openPeering?s.sessionCount<s.sessionCapacity?s.autoPeering?o(t)("pages.nodes.statusOpen"):o(t)("pages.nodes.statusOpenManuallyReview"):o(t)("pages.nodes.statusFull"):o(t)("pages.nodes.statusClosed")} ${o(t)("pages.nodes.statusCapacity")}: ${s.sessionCount}/${s.sessionCapacity}`},{avatar:f(()=>[r(X,{router:s},null,8,["router"])]),_:2},1032,["title","description"]),c("ul",{class:j(`detail ${o(U)}`)},[s.ipv4?(n(),i("li",ae,[a[1]||(a[1]=y("IPv4")),c("code",null,p(s.ipv4),1)])):v("",!0),s.ipv6?(n(),i("li",te,[a[2]||(a[2]=y("IPv6")),c("code",null,p(s.ipv6),1)])):v("",!0),s.ipv6LinkLocal?(n(),i("li",oe,[a[3]||(a[3]=y("IPv6 Link Local")),c("code",null,p(s.ipv6LinkLocal),1)])):v("",!0)],2),s.description?(n(),i("div",{key:0,class:"desc",innerHTML:o(L).render(s.description)},null,8,ne)):v("",!0)]),_:2},1032,["onClick"]))),128))])):(n(),i("section",ie,[r(E,{image:o(P)},null,8,["image"])]))])}}}),pe=W(le,[["__scopeId","data-v-fad03cab"]]);export{pe as default};
