import{d as A,u as T,a as b,M as B,m as D,r as m,o as F,z as J,J as V,b as u,e as o,f as n,l as r,q as p,h as t,c as l,F as H,k as q,i as z,j as G,g,K as I,N as K,s as f,y as v,n as j,t as U,E as x,G as O,H as Q,_ as W}from"./index-tT9SxIPK.js";import{R as X}from"./RouterLocationAvatar-DcqCds2h.js";import{A as Y}from"./ApiOutlined-S85r4nYw.js";const Z={class:"header"},ee={class:"searchContainer"},se={key:0,id:"routers"},ae={key:0},te={key:1},oe={key:2},ne=["innerHTML"],ie={key:1,id:"noData"},le=A({__name:"nodes",setup(ce){const a=T().t,h=b(),y=new B;y.use(D,{attrs:{target:"_blank"}});const C=m(!1),d=m([]),M=async()=>{try{C.value=!0;const e=await z(a,"/list",{type:"routers"});Array.isArray(e.routers)&&(d.value=e.routers.sort((c,_)=>(""+c.name).localeCompare(_.name)),localStorage.setItem("routers",JSON.stringify(d.value)))}catch(e){console.error(e)}finally{C.value=!1}};F(async()=>{try{const e=localStorage.getItem("routers");e&&(d.value=JSON.parse(e))}catch(e){console.error(e)}await M()});const N=async e=>{try{await navigator.clipboard.writeText(JSON.stringify(e)),x.info(a("pages.nodes.copied"))}catch(c){console.error(c)}},L=e=>{if(!e.openPeering){O.error({centered:!0,title:e.name,content:a("pages.nodes.statusClosed")});return}if(e.sessionCount>=e.sessionCapacity){O.error({centered:!0,title:e.name,content:a("pages.nodes.statusFull")});return}if(!Q.value){x.info(a("pages.nodes.pleaseSignIn")),h.replace({path:"/signin"});return}h.push({path:`/nodes/${e.uuid}`})},i=m(""),k=J(()=>i.value.length===0?d.value:d.value.filter(e=>e.name!==void 0&&e.name!==null&&e.name.toLocaleLowerCase().indexOf(i.value.toLocaleLowerCase())!==-1||e.ipv4!==void 0&&e.ipv4!==null&&e.ipv4.indexOf(i.value)!==-1||e.ipv6!==void 0&&e.ipv6!==null&&e.ipv6.toLocaleLowerCase().indexOf(i.value.toLocaleLowerCase())!==-1||e.ipv6LinkLocal!==void 0&&e.ipv6LinkLocal!==null&&e.ipv6LinkLocal.toLocaleLowerCase().indexOf(i.value.toLocaleLowerCase())!==-1)),R=V.PRESENTED_IMAGE_SIMPLE;return(e,c)=>{const _=u("a-divider"),P=u("a-input-search"),S=u("a-card-meta"),$=u("a-card"),E=u("a-empty");return o(),n("section",null,[r("h1",Z,p(t(a)("pages.nodes.nodes")),1),l(_,{dashed:""}),r("div",ee,[l(P,{value:i.value,"onUpdate:value":c[0]||(c[0]=s=>i.value=s),placeholder:t(a)("pages.nodes.search"),class:"searchBox","enter-button":""},null,8,["value","placeholder"])]),k.value.length!==0?(o(),n("section",se,[(o(!0),n(H,null,q(k.value,s=>(o(),G($,{hoverable:"",class:"card",key:s.uuid,onClick:w=>L(s)},{actions:g(()=>[l(t(K),{onClick:I(w=>N(s),["stop"])},null,8,["onClick"]),l(t(Y),{onClick:I(w=>L(s),["stop"])},null,8,["onClick"])]),default:g(()=>[l(S,{title:s.name,description:`${s.openPeering?s.sessionCount<s.sessionCapacity?s.autoPeering?t(a)("pages.nodes.statusOpen"):t(a)("pages.nodes.statusOpenManuallyReview"):t(a)("pages.nodes.statusFull"):t(a)("pages.nodes.statusClosed")} ${t(a)("pages.nodes.statusCapacity")}: ${s.sessionCount}/${s.sessionCapacity}`},{avatar:g(()=>[l(X,{router:s},null,8,["router"])]),_:2},1032,["title","description"]),r("ul",{class:j(`detail ${t(U)}`)},[s.ipv4?(o(),n("li",ae,[f("IPv4"),r("code",null,p(s.ipv4),1)])):v("",!0),s.ipv6?(o(),n("li",te,[f("IPv6"),r("code",null,p(s.ipv6),1)])):v("",!0),s.ipv6LinkLocal?(o(),n("li",oe,[f("IPv6 Link Local"),r("code",null,p(s.ipv6LinkLocal),1)])):v("",!0)],2),s.description?(o(),n("div",{key:0,class:"desc",innerHTML:t(y).render(s.description)},null,8,ne)):v("",!0)]),_:2},1032,["onClick"]))),128))])):(o(),n("section",ie,[l(E,{image:t(R)},null,8,["image"])]))])}}}),pe=W(le,[["__scopeId","data-v-70039259"]]);export{pe as default};
